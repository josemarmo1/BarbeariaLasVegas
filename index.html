<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Barbearia Las Vegas</title>

  <!-- ‚úÖ Use o logo novo aqui (coloque o arquivo em /assets/logo-las-vegas.png) -->
  <link rel="icon" type="image/png" href="/imagens/logo.png">

  <!-- Fonts (premium) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* ===== Paleta igual ao seu logo (vermelho + dourado/laranja + teal/azul) ===== */
      --bg0:#071028;
      --bg1:#0b1f3f;
      --bg2:#0a2f4a;
      --bg3:#113a3f;

      --card: rgba(255,255,255,.085);
      --card2: rgba(255,255,255,.06);
      --glass: rgba(255,255,255,.05);
      --line: rgba(255,255,255,.18);

      --text:#f7f7ff;
      --muted:#d7dde8;

      --gold:#fbbf24;      /* dourado */
      --gold2:#f97316;     /* laranja */
      --red:#ef4444;       /* vermelho */
      --red2:#dc2626;      /* vermelho forte */
      --teal:#06b6d4;      /* teal */
      --blue:#2563eb;      /* azul */

      --ok:#22c55e;
      --bad:#fb7185;

      --radius: 22px;
      --shadow: 0 24px 70px rgba(0,0,0,.45);
    }

    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      font-family: "Poppins", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      overflow-x:hidden;

      /* ‚úÖ Fundo com as cores do logo (sem preto chapado) */
      background:
        radial-gradient(900px 520px at 14% 10%, rgba(239,68,68,.18), transparent 58%),      /* vermelho */
        radial-gradient(900px 520px at 88% 12%, rgba(6,182,212,.18), transparent 60%),      /* teal */
        radial-gradient(900px 520px at 70% 92%, rgba(251,191,36,.16), transparent 62%),     /* dourado */
        radial-gradient(800px 520px at 18% 92%, rgba(249,115,22,.14), transparent 60%),     /* laranja */
        linear-gradient(135deg, var(--bg1), var(--bg2) 48%, var(--bg3));
      background-attachment: fixed;
    }

    /* grain premium */
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:
        radial-gradient(circle at 25% 25%, rgba(255,255,255,.05) 0 1px, transparent 2px),
        radial-gradient(circle at 80% 60%, rgba(255,255,255,.04) 0 1px, transparent 2px),
        radial-gradient(circle at 40% 75%, rgba(255,255,255,.03) 0 1px, transparent 2px);
      background-size: 240px 240px, 300px 300px, 360px 360px;
      opacity:.33;
      mix-blend-mode: overlay;
    }

    a{ color:inherit; text-decoration:none }
    .container{ max-width:1180px; margin:0 auto; padding:26px }
    @media (max-width:520px){ .container{ padding:16px } }

    /* ===== Topbar (ultra) ===== */
    .topbar{
      position:relative;
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      padding:16px 18px;
      border:1px solid var(--line);
      border-radius: 24px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    /* ‚úÖ sweep com cores do logo */
    .topbar:after{
      content:"";
      position:absolute;
      inset:-60% -60%;
      background:
        linear-gradient(110deg,
          transparent 0%,
          rgba(239,68,68,.14) 30%,
          rgba(6,182,212,.14) 45%,
          rgba(251,191,36,.14) 58%,
          rgba(249,115,22,.12) 66%,
          transparent 78%
        );
      transform: translateX(-40%);
      animation: sweep 7.5s linear infinite;
      pointer-events:none;
      opacity:.95;
    }
    @keyframes sweep{
      0%{ transform: translateX(-50%) rotate(0.001deg); }
      100%{ transform: translateX(50%) rotate(0.001deg); }
    }

    .brand{ display:flex; align-items:center; gap:12px; min-width:0; z-index:1; }
    /* ‚úÖ Logo novo (maior, sem borda, com glow Vegas) */
    .brand img{
      height:80px;
      width:auto;
      object-fit:contain;
      border:none;
      background:transparent;
      filter: drop-shadow(0 0 14px rgba(239,68,68,.25))
              drop-shadow(0 0 18px rgba(251,191,36,.22))
              drop-shadow(0 0 16px rgba(6,182,212,.18));
    }

    .titles{ min-width:0 }
    .titles .name{
      font-family:"Playfair Display", serif;
      font-weight:800;
      letter-spacing:.7px;
      font-size:20px;
      line-height:1.1;
      background: linear-gradient(90deg, var(--gold), rgba(255,255,255,.98), var(--red));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      text-shadow: 0 0 18px rgba(251,191,36,.14);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .titles .sub{
      margin-top:2px;
      font-size:12px;
      color:rgba(215,221,232,.94);
      letter-spacing:.2px;
    }

    .navlinks{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end; z-index:1 }
    .badge{
      font-size:12px;
      color:rgba(247,247,255,.92);
      border:1px solid rgba(255,255,255,.18);
      padding:8px 12px;
      border-radius:999px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      backdrop-filter: blur(12px);
      box-shadow: 0 0 22px rgba(251,191,36,.10);
      animation: flicker 6.2s infinite;
      white-space:nowrap;
    }
    @keyframes flicker{
      0%,100%{ opacity:1 }
      45%{ opacity:.92 }
      55%{ opacity:1 }
      58%{ opacity:.78 }
      62%{ opacity:1 }
    }

    /* ===== Buttons ===== */
    .btn{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      color:var(--text);
      padding:11px 14px;
      border-radius: 16px;
      transition: transform .12s ease, box-shadow .25s ease, border-color .25s ease, filter .25s ease;
      box-shadow: 0 14px 34px rgba(0,0,0,.25);
      user-select:none;
      display:inline-flex; align-items:center; gap:8px;
      white-space:nowrap;
      font-weight:700;
      letter-spacing:.2px;
    }
    .btn:hover{
      transform: translateY(-2px);
      border-color: rgba(239,68,68,.28);
      box-shadow: 0 18px 44px rgba(0,0,0,.32), 0 0 0 3px rgba(239,68,68,.10) inset;
    }
    .btn:active{ transform: translateY(0px) scale(.99) }

    /* ‚úÖ Secondary no azul/teal do logo */
    .btn.secondary{
      border:none;
      background: linear-gradient(90deg, rgba(6,182,212,.96), rgba(37,99,235,.92));
      box-shadow:
        0 18px 44px rgba(0,0,0,.30),
        0 0 26px rgba(6,182,212,.14),
        0 0 22px rgba(37,99,235,.12);
    }
    .btn.secondary:hover{
      filter: brightness(1.03);
      box-shadow:
        0 22px 54px rgba(0,0,0,.34),
        0 0 34px rgba(6,182,212,.16),
        0 0 30px rgba(37,99,235,.14);
    }

    /* ‚úÖ Primary dourado/laranja (placa Vegas) */
    .btn.primary{
      border:none;
      color:#140c2a;
      background: linear-gradient(90deg, var(--gold), var(--gold2));
      box-shadow:
        0 18px 44px rgba(0,0,0,.30),
        0 0 28px rgba(251,191,36,.18);
      position:relative;
      overflow:hidden;
    }
    /* ‚Äúbrilho passando‚Äù no bot√£o */
    .btn.primary:after{
      content:"";
      position:absolute;
      inset:-40% -40%;
      background: linear-gradient(110deg, transparent 25%, rgba(255,255,255,.35) 45%, transparent 65%);
      transform: translateX(-60%);
      animation: shine 2.8s ease-in-out infinite;
      opacity:.55;
      pointer-events:none;
    }
    @keyframes shine{
      0%{ transform: translateX(-65%); }
      55%{ transform: translateX(65%); }
      100%{ transform: translateX(65%); }
    }

    /* ===== HERO (absurdo) ===== */
    .hero{
      margin-top:18px;
      border:1px solid rgba(255,255,255,.16);
      border-radius: 28px;

      /* ‚úÖ Hero com as cores do logo */
      background:
        radial-gradient(900px 520px at 18% 18%, rgba(239,68,68,.16), transparent 58%),
        radial-gradient(700px 520px at 85% 20%, rgba(6,182,212,.16), transparent 60%),
        radial-gradient(700px 520px at 65% 92%, rgba(251,191,36,.14), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      isolation:isolate;
    }

    /* borda neon */
    .hero:before{
      content:"";
      position:absolute; inset:-1px;
      background:
        linear-gradient(120deg,
          rgba(239,68,68,.24),
          rgba(6,182,212,.18),
          rgba(251,191,36,.18),
          rgba(255,255,255,.06)
        );
      opacity:.65;
      pointer-events:none;
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      padding:1px;
      border-radius: 28px;
      z-index:0;
    }

    /* ‚úÖ Marca d‚Äô√°gua do logo no HERO (gigante + animada) */
    .heroWatermark{
      position:absolute;
      inset:auto -10% -35% -10%;
      height: 120%;
      display:flex;
      justify-content:center;
      align-items:flex-end;
      pointer-events:none;
      z-index:0;
      opacity:.14;
      transform: rotate(-10deg);
      filter: blur(.1px);
      animation: floatWM 7.5s ease-in-out infinite;
    }
    .heroWatermark img{
      width:min(900px, 120%);
      height:auto;
      object-fit:contain;
      filter: drop-shadow(0 0 26px rgba(251,191,36,.22))
              drop-shadow(0 0 22px rgba(239,68,68,.18))
              drop-shadow(0 0 20px rgba(6,182,212,.16));
    }
    @keyframes floatWM{
      0%,100%{ transform: translateY(0) rotate(-10deg) }
      50%{ transform: translateY(-10px) rotate(-10deg) }
    }

    /* ‚Äúluzes‚Äù tipo marquee Vegas */
    .marquee{
      position:absolute;
      inset: -80px -80px auto -80px;
      height: 180px;
      background:
        radial-gradient(circle at 15% 50%, rgba(251,191,36,.28), transparent 55%),
        radial-gradient(circle at 45% 40%, rgba(239,68,68,.18), transparent 58%),
        radial-gradient(circle at 75% 60%, rgba(6,182,212,.18), transparent 58%);
      filter: blur(18px);
      opacity:.7;
      z-index:0;
      animation: marqueeGlow 4.2s ease-in-out infinite;
    }
    @keyframes marqueeGlow{
      0%,100%{ opacity:.65; transform: translateX(0) }
      50%{ opacity:.9; transform: translateX(10px) }
    }

    .heroInner{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      padding:22px;
      position:relative;
      z-index:1;
      align-items:stretch;
    }
    @media (max-width: 960px){
      .heroInner{ grid-template-columns: 1fr; }
    }

    .heroCopy{
      padding:10px 8px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:12px;
    }
    .heroTitle{
      font-family:"Playfair Display", serif;
      font-weight:800;
      font-size: 38px;
      letter-spacing:.4px;
      margin:0;
      line-height:1.05;
      text-shadow: 0 0 18px rgba(251,191,36,.10);
    }
    @media (max-width:520px){
      .heroTitle{ font-size: 30px; }
    }
    .heroTitle span{
      background: linear-gradient(90deg, var(--gold), rgba(255,255,255,.98), var(--red));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .heroDesc{
      margin:0;
      color:rgba(215,221,232,.96);
      font-size:14px;
      line-height:1.6;
      max-width: 56ch;
    }

    .heroStats{
      display:flex; flex-wrap:wrap; gap:10px;
      margin-top:4px;
    }
    .stat{
      padding:10px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
      min-width: 160px;
      flex: 1;
      position:relative;
      overflow:hidden;
    }
    .stat:after{
      content:"";
      position:absolute; inset:-40% -40%;
      background: linear-gradient(110deg, transparent 30%, rgba(255,255,255,.16) 50%, transparent 70%);
      transform: translateX(-65%);
      animation: statShine 6.5s ease-in-out infinite;
      opacity:.45;
      pointer-events:none;
    }
    @keyframes statShine{
      0%{ transform: translateX(-70%); }
      50%{ transform: translateX(70%); }
      100%{ transform: translateX(70%); }
    }

    .stat b{ display:block; font-size:16px; letter-spacing:.2px; }
    .stat small{ color:rgba(215,221,232,.92) }

    .heroActions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:8px; }
    .heroNote{
      display:flex;
      align-items:center;
      gap:10px;
      color:rgba(215,221,232,.92);
      font-size:12px;
      margin-top:6px;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--teal));
      box-shadow: 0 0 14px rgba(6,182,212,.35);
    }

    .heroMedia{
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 170px 170px;
      gap:12px;
    }
    @media (max-width:520px){
      .heroMedia{ grid-template-rows: 150px 150px; }
    }
    .shot{
      position:relative;
      border-radius: 20px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.05);
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      transform: translateZ(0);
    }
    .shot img{
      width:100%; height:100%;
      object-fit:cover;
      filter: saturate(1.15) contrast(1.05) brightness(.92);
      transform: scale(1.04);
      transition: transform .6s ease, filter .6s ease;
      display:block;
    }
    .shot:hover img{
      transform: scale(1.10);
      filter: saturate(1.2) contrast(1.1) brightness(1);
    }
    .shot:after{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(180deg, transparent 40%, rgba(0,0,0,.40)),
        radial-gradient(600px 320px at 20% 20%, rgba(239,68,68,.18), transparent 55%),
        radial-gradient(520px 320px at 80% 20%, rgba(6,182,212,.18), transparent 55%),
        radial-gradient(520px 320px at 70% 90%, rgba(251,191,36,.14), transparent 60%);
      pointer-events:none;
    }
    /* ‚úÖ etiqueta estilo placa */
    .shotTag{
      position:absolute;
      left:12px; bottom:12px;
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      border:1px solid rgba(255,255,255,.16);
      background: linear-gradient(90deg, rgba(251,191,36,.18), rgba(249,115,22,.12));
      backdrop-filter: blur(10px);
      box-shadow: 0 0 18px rgba(251,191,36,.18);
      letter-spacing:.2px;
    }

    /* ===== Mini sections ===== */
    .sectionRow{
      margin-top:16px;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 920px){
      .sectionRow{ grid-template-columns: 1fr; }
    }
    .miniCard{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(14px);
      border-radius: 22px;
      padding:16px;
      box-shadow: 0 18px 50px rgba(0,0,0,.30);
      position:relative;
      overflow:hidden;
    }
    .miniCard:before{
      content:"";
      position:absolute; inset:-1px;
      background: linear-gradient(120deg, rgba(239,68,68,.18), rgba(6,182,212,.14), rgba(251,191,36,.14), rgba(255,255,255,.06));
      opacity:.6;
      pointer-events:none;
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      padding:1px;
      border-radius: 22px;
    }
    .miniCard h3{
      margin:0 0 6px 0;
      font-family:"Playfair Display", serif;
      font-size:18px;
      letter-spacing:.2px;
    }
    .miniCard p{
      margin:0;
      color:rgba(215,221,232,.95);
      font-size:13px;
      line-height:1.6;
    }

    /* ===== Main grid ===== */
    .grid{
      display:grid;
      gap:16px;
      grid-template-columns: 1.12fr .88fr;
      margin-top:16px;
    }
    @media (max-width: 920px){
      .grid{ grid-template-columns: 1fr }
      .navlinks{ justify-content:flex-start }
    }
    @media (max-width:520px){
      .topbar{ flex-direction:column; align-items:stretch }
      .navlinks{ justify-content:flex-start }
      .btn{ width:100%; justify-content:center }
      .badge{ width:fit-content }
    }

    /* ===== Cards (main) ===== */
    .card{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.07);
      backdrop-filter: blur(18px);
      border-radius: 26px;
      box-shadow: var(--shadow);
      padding:20px;
      position:relative;
      overflow:hidden;
    }
    .card:before{
      content:"";
      position:absolute; inset:-1px;
      border-radius: 26px;
      padding:1px;
      background:
        linear-gradient(120deg,
          rgba(239,68,68,.22),
          rgba(6,182,212,.16),
          rgba(251,191,36,.16),
          rgba(255,255,255,.06)
        );
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events:none;
      opacity:.62;
    }

    .card h2{
      margin:0 0 8px 0;
      font-family:"Playfair Display", serif;
      font-size:22px;
      letter-spacing:.2px;
    }
    .muted{ color:rgba(215,221,232,.92) }
    .small{ font-size:12px }
    .hr{ height:1px; background:rgba(255,255,255,.12); margin:14px 0 }
    .row{ display:flex; gap:10px; flex-wrap:wrap }
    .field{ display:flex; flex-direction:column; gap:7px; margin:10px 0; }
    .field label{ font-size:12px; color:rgba(215,221,232,.92); letter-spacing:.2px }

    .input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--text);
      outline:none;
      box-shadow: 0 10px 28px rgba(0,0,0,.18) inset;
    }
    .input::placeholder, textarea::placeholder{ color:rgba(215,221,232,.72) }
    .input:focus, select:focus, textarea:focus{
      border-color: rgba(251,191,36,.60);
      box-shadow: 0 0 0 3px rgba(251,191,36,.14), 0 14px 34px rgba(0,0,0,.22) inset;
    }
    textarea{ min-height:96px; resize:vertical }

    .list{ display:flex; flex-direction:column; gap:10px; }

    .item{
      border:1px solid rgba(255,255,255,.12);
      border-radius:20px;
      padding:14px;
      background: rgba(255,255,255,.06);
      box-shadow: 0 18px 44px rgba(0,0,0,.24);
    }
    .item .top{ display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; align-items:flex-start }
    .item .title{ font-weight:800; letter-spacing:.15px }
    .item .meta{ color:rgba(215,221,232,.92); font-size:12px; margin-top:5px; line-height:1.35 }

    .pills{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; align-items:center }
    .pill{
      font-size:12px; padding:7px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(247,247,255,.92);
      letter-spacing:.15px;
      font-weight:700;
    }
    .pill.brand{ color: var(--gold); border-color: rgba(251,191,36,.30) }
    .pill.ok{ color: var(--ok); border-color: rgba(34,197,94,.28) }
    .pill.bad{ color: var(--bad); border-color: rgba(251,113,133,.28) }
    .pill.info{ color: #93c5fd; border-color: rgba(147,197,253,.28) }

    .slots{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(86px, 1fr));
      gap:10px;
      margin-top:8px;
    }
    .slot{
      padding:10px 10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      cursor:pointer;
      transition: transform .12s ease, border-color .25s ease, box-shadow .25s ease, background .25s ease, color .25s ease;
      color: var(--text);
      font-weight:900;
      letter-spacing:.25px;
      box-shadow: 0 14px 34px rgba(0,0,0,.22);
    }
    .slot:hover{
      transform: translateY(-2px);
      border-color: rgba(239,68,68,.32);
      box-shadow: 0 0 0 3px rgba(239,68,68,.10) inset, 0 18px 44px rgba(0,0,0,.28);
    }
    .slot[aria-selected="true"]{
      border-color: rgba(251,191,36,.70);
      box-shadow: 0 0 0 3px rgba(251,191,36,.14) inset, 0 0 26px rgba(251,191,36,.18);
      background: linear-gradient(90deg, rgba(251,191,36,.95), rgba(249,115,22,.90));
      color:#1b103d;
    }
    .slot[aria-disabled="true"]{
      opacity:.46;
      cursor:not-allowed;
      transform:none;
      box-shadow:none;
    }

    .footer{
      margin:18px 0 4px 0;
      color:rgba(215,221,232,.90);
      font-size:12px;
      line-height:1.5;
    }

    /* Toast */
    .toast{
      position:fixed; right:18px; bottom:18px; max-width:min(420px, calc(100vw - 36px));
      padding:12px 14px; border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background:
        radial-gradient(300px 160px at 20% 20%, rgba(239,68,68,.16), transparent 55%),
        radial-gradient(300px 160px at 85% 25%, rgba(6,182,212,.14), transparent 58%),
        radial-gradient(300px 160px at 65% 90%, rgba(251,191,36,.14), transparent 60%),
        rgba(255,255,255,.07);
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      display:none;
      z-index:9999;
      font-weight:800;
      letter-spacing:.2px;
    }
    .toast.show{ display:block }

    html{ scroll-behavior:smooth; }
  </style>
</head>

<body>
  <div class="container">
    <!-- TOPBAR -->
    <div class="topbar">
      <div class="brand">
        <!-- ‚úÖ Troquei para o logo novo -->
        <img src="/imagens/logo.png" alt="Barbearia Las Vegas Logo">
        <div class="titles">
          <div class="name" id="brandName">Barbearia Las Vegas</div>
          <div class="sub">Agenda online</div>
        </div>
      </div>

      <div class="navlinks">
        <span class="badge" id="kOpen">Carregando‚Ä¶</span>

        <!-- LINKS (mantidos) -->
        <a class="btn secondary" href="./barbeiro.html" aria-label="Ir para √°rea do barbeiro">√Årea do Barbeiro</a>
        <a class="btn primary" href="./admin.html" aria-label="Ir para √°rea do admin">Admin</a>
      </div>
    </div>

    <!-- HERO -->
    <div class="hero">
      <div class="marquee"></div>

      <!-- ‚úÖ Marca d‚Äô√°gua gigante do logo -->
      <div class="heroWatermark" aria-hidden="true">
        <img src="/imagens/logo.png" alt="">
      </div>

      <div class="heroInner">
        <div class="heroCopy">
          <h1 class="heroTitle">Seu corte com <span>vibe Las Vegas</span>.</h1>
          <p class="heroDesc">
            Agendamento r√°pido, visual premium e acabamento impec√°vel. Escolha servi√ßo, barbeiro, data e hor√°rio ‚Äî e pronto.
            Aqui √© degrad√™ limpo, barba alinhada e presen√ßa de respeito.
          </p>

          <div class="heroStats">
            <div class="stat">
              <b>Agende em 30s</b>
              <small>Sem enrola√ß√£o</small>
            </div>
            <div class="stat">
              <b>Acabamento premium</b>
              <small>Detalhe que destaca</small>
            </div>
            <div class="stat">
              <b>Calend√°rio 1 clique</b>
              <small>.ics autom√°tico</small>
            </div>
          </div>

          <div class="heroActions">
            <a class="btn primary" href="#agendar">Agendar agora</a>
            <a class="btn" href="#meus">Ver meus agendamentos</a>
          </div>

          <div class="heroNote">
            <span class="dot"></span>
            <span>Hor√°rio de hoje e regras de cancelamento aparecem no topo automaticamente.</span>
          </div>
        </div>

        <!-- GALERIA (mantive imagens de exemplo; voc√™ pode trocar por fotos reais) -->
        <div class="heroMedia" aria-label="Galeria de trabalhos">
          <div class="shot">
            <img alt="Corte degrad√™ premium"
                 src="https://images.unsplash.com/photo-1599351431202-1e0f0137899a?auto=format&fit=crop&w=1200&q=70">
            <div class="shotTag">Degrad√™ ‚Ä¢ Limpo</div>
          </div>
          <div class="shot">
            <img alt="Barba alinhada"
                 src="https://images.unsplash.com/photo-1585747860715-2ba37e788b70?auto=format&fit=crop&w=1200&q=70">
            <div class="shotTag">Barba ‚Ä¢ Alinhada</div>
          </div>
          <div class="shot">
            <img alt="Ambiente barbearia"
                 src="https://images.unsplash.com/photo-1621605815971-fbc98d665033?auto=format&fit=crop&w=1200&q=70">
            <div class="shotTag">Ambiente ‚Ä¢ Vegas</div>
          </div>
          <div class="shot">
            <img alt="Acabamento premium"
                 src="https://images.unsplash.com/photo-1605497788044-5a32c7078486?auto=format&fit=crop&w=1200&q=70">
            <div class="shotTag">Acabamento ‚Ä¢ Premium</div>
          </div>
        </div>
      </div>
    </div>

    <!-- MINI SECTIONS -->
    <div class="sectionRow">
      <div class="miniCard">
        <h3>‚ú® Experi√™ncia</h3>
        <p>Visual neon, atendimento alinhado e finaliza√ß√£o impec√°vel ‚Äî do jeito que ‚Äúmarca presen√ßa‚Äù.</p>
      </div>
      <div class="miniCard">
        <h3>ü™í Precis√£o</h3>
        <p>Hor√°rios organizados, escolha de barbeiro e encaixe inteligente com dura√ß√£o por servi√ßo.</p>
      </div>
      <div class="miniCard">
        <h3>üìÖ Calend√°rio</h3>
        <p>Gere o evento (.ics) em 1 clique e n√£o esque√ßa seu hor√°rio. Simples e premium.</p>
      </div>
    </div>

    <!-- MAIN GRID -->
    <div class="grid">
      <!-- AGENDAR -->
      <div class="card" id="agendar">
        <h2>Agendar hor√°rio</h2>
        <div class="muted small">Escolha servi√ßo, barbeiro, data e hor√°rio. Tudo r√°pido e com visual premium.</div>
        <div class="hr"></div>

        <div class="row">
          <div style="flex:1; min-width:220px" class="field">
            <label>Servi√ßo</label>
            <select id="svc"></select>
          </div>
          <div style="flex:1; min-width:220px" class="field">
            <label>Barbeiro</label>
            <select id="barber"></select>
          </div>
        </div>

        <div class="row">
          <div style="flex:1; min-width:220px" class="field">
            <label>Data</label>
            <select id="date"></select>
          </div>
          <div style="flex:1; min-width:220px" class="field">
            <label>Hor√°rios dispon√≠veis</label>
            <div id="slots" class="slots"></div>
            <div class="muted small" id="slotsHint"></div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="row">
          <div style="flex:1; min-width:220px" class="field">
            <label>Seu nome</label>
            <input class="input" id="custName" placeholder="Ex: Jo√£o Silva">
          </div>
          <div style="flex:1; min-width:220px" class="field">
            <label>Telefone</label>
            <input class="input" id="custPhone" placeholder="Ex: (11) 99999-9999">
          </div>
        </div>

        <div class="field">
          <label>Observa√ß√£o (opcional)</label>
          <textarea id="notes" placeholder="Ex: Degrad√™ baixo, n√£o tirar muito em cima‚Ä¶"></textarea>
        </div>

        <div class="row" style="justify-content:space-between; align-items:center">
          <div class="muted small" id="policyText"></div>
          <button class="btn primary" id="confirmBtn">Confirmar agendamento</button>
        </div>

        <div class="hr"></div>

        <div class="item" id="receipt" style="display:none">
          <div class="top">
            <div>
              <div class="title">Agendamento confirmado ‚úÖ</div>
              <div class="meta" id="receiptMeta"></div>
            </div>
            <div class="pills">
              <span class="pill ok" id="receiptCode"></span>
              <button class="btn secondary" id="icsBtn">Adicionar ao calend√°rio</button>
            </div>
          </div>
          <div class="pills" id="receiptPills"></div>
        </div>
      </div>

      <!-- MEUS AGENDAMENTOS -->
      <div class="card" id="meus">
        <h2>Meus agendamentos</h2>
        <div class="muted small">Digite seu telefone para ver ou cancelar (respeitando o prazo).</div>

        <div class="row" style="align-items:end">
          <div style="flex:1; min-width:220px" class="field">
            <label>Telefone</label>
            <input class="input" id="lookupPhone" placeholder="Ex: (11) 99999-9999">
          </div>
          <button class="btn secondary" id="lookupBtn">Buscar</button>
        </div>

        <div class="hr"></div>
        <div id="myList" class="list"></div>

        <div class="footer">
          Dica: salve o c√≥digo do seu agendamento (fica no comprovante).<br>
          Se ‚ÄúCancelar‚Äù estiver desabilitado, passou do prazo configurado no Admin.
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <!-- ‚úÖ N√ÉO MEXI EM NADA DO BANCO / SUPABASE -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
/* Utils */
const LV = (() => {
  const uid = (prefix="") => {
    const r = Math.random().toString(36).slice(2, 8).toUpperCase();
    const t = Date.now().toString(36).toUpperCase().slice(-4);
    return (prefix + r + t).slice(0, 12);
  };

  const toMin = (hhmm) => {
    const [h,m] = String(hhmm).split(":").map(Number);
    return h*60 + (m||0);
  };
  const toHHMM = (mins) => {
    const h = Math.floor(mins/60);
    const m = mins%60;
    return String(h).padStart(2,"0")+":"+String(m).padStart(2,"0");
  };

  const todayISO = () => {
    const d = new Date();
    d.setHours(0,0,0,0);
    return d.toISOString().slice(0,10);
  };

  const addDaysISO = (iso, days) => {
    const d = new Date(iso+"T00:00:00");
    d.setDate(d.getDate()+days);
    return d.toISOString().slice(0,10);
  };

  const weekdayIndex = (iso) => new Date(iso+"T00:00:00").getDay();

  const formatBR = (iso) => {
    const d = new Date(iso+"T00:00:00");
    const dd = String(d.getDate()).padStart(2,"0");
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const yyyy = d.getFullYear();
    return `${dd}/${mm}/${yyyy}`;
  };

  const toast = (msg) => {
    const el = document.querySelector("#toast");
    if(!el){ alert(msg); return; }
    el.textContent = msg;
    el.classList.add("show");
    setTimeout(()=>el.classList.remove("show"), 2600);
  };

  const nowISOTime = () => {
    const d = new Date();
    const iso = d.toISOString().slice(0,10);
    const hhmm = String(d.getHours()).padStart(2,"0")+":"+String(d.getMinutes()).padStart(2,"0");
    return { iso, hhmm };
  };

  const ts = (dateISO, timeHHMM) => new Date(`${dateISO}T${timeHHMM}:00`).getTime();

  return { uid, toMin, toHHMM, todayISO, addDaysISO, weekdayIndex, formatBR, toast, nowISOTime, ts };
})();
  </script>

  <script>
/** SUPABASE (mantido) */
const SUPABASE_URL = "https://dpvgcjzsigaqnqainmro.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_931ojZ41L4aq-rctZFIFuw_-3qCo1qB";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/** DB (mantido) */
const DB = {
  async getConfig(){
    const { data, error } = await sb.from("lv_config").select("*").eq("id", 1).maybeSingle();
    if(error) throw error;
    return data;
  },
  async listServices(){
    const { data, error } = await sb.from("lv_services").select("*").eq("active", true).order("created_at", { ascending:true });
    if(error) throw error;
    return data || [];
  },
  async listBarbers(){
    const { data, error } = await sb.from("lv_barbers").select("*").eq("active", true).order("created_at", { ascending:true });
    if(error) throw error;
    return data || [];
  },
  async listHours(){
    const { data, error } = await sb.from("lv_hours").select("*").order("weekday", { ascending:true });
    if(error) throw error;
    return data || [];
  },
  async listBookingsForSlotCalc({ dateISO, barberId }){
    const { data, error } = await sb
      .from("lv_bookings")
      .select("id,time_hhmm,duration_min,status")
      .eq("date_iso", dateISO)
      .eq("barber_id", barberId)
      .not("status", "in", '("cancelado","nao_compareceu")');
    if(error) throw error;
    return data || [];
  },
  async createBooking(b){
    const { error } = await sb.from("lv_bookings").insert(b);
    if(error) throw error;
  },
  async listMyBookingsByPhone(phone){
    const { data, error } = await sb
      .from("lv_bookings")
      .select("*")
      .eq("customer_phone", phone)
      .order("date_iso", { ascending:true })
      .order("time_hhmm", { ascending:true });
    if(error) throw error;
    return data || [];
  },
  async cancelBooking({ id, phone }){
    const { error } = await sb
      .from("lv_bookings")
      .update({ status: "cancelado", updated_at: new Date().toISOString() })
      .eq("id", id)
      .eq("customer_phone", phone);
    if(error) throw error;
  }
};

/** UI */
const elBrand = document.querySelector("#brandName");
const elSvc = document.querySelector("#svc");
const elBarber = document.querySelector("#barber");
const elDate = document.querySelector("#date");
const elSlots = document.querySelector("#slots");
const elSlotsHint = document.querySelector("#slotsHint");
const elPolicy = document.querySelector("#policyText");
const elOpen = document.querySelector("#kOpen");

const elName = document.querySelector("#custName");
const elPhone = document.querySelector("#custPhone");
const elNotes = document.querySelector("#notes");
const elConfirm = document.querySelector("#confirmBtn");

const receipt = document.querySelector("#receipt");
const receiptMeta = document.querySelector("#receiptMeta");
const receiptCode = document.querySelector("#receiptCode");
const receiptPills = document.querySelector("#receiptPills");
const icsBtn = document.querySelector("#icsBtn");

const lookupPhone = document.querySelector("#lookupPhone");
const lookupBtn = document.querySelector("#lookupBtn");
const myList = document.querySelector("#myList");

let selectedTime = null;
let lastCreated = null;

let CFG = null;
let SERVICES = [];
let BARBERS = [];
let HOURS = new Map(); // weekday -> row

let bookingCacheKey = "";
let bookingCache = [];

const normPhone = (p) => (p||"").replace(/\D/g,"");
const money = (n) => (n==null||n==="") ? "" : ("R$ " + Number(n).toFixed(2).replace(".",","));
const weekdayName = (i) => ["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"][i];

function getHourForISO(dateISO){
  const wd = LV.weekdayIndex(dateISO);
  return HOURS.get(wd) || { open:false, start_time:"09:00", end_time:"18:00" };
}

function refreshTop(){
  elBrand.textContent = CFG?.brand_name || "Barbearia Las Vegas";

  const today = LV.todayISO();
  const h = getHourForISO(today);
  elOpen.textContent = h.open ? `Hoje: ${h.start_time}‚Äì${h.end_time}` : "Hoje: Fechado";

  const cancelH = Math.round((CFG?.cancel_limit_min ?? 180)/60);
  const advH = Math.round((CFG?.min_advance_min ?? 60)/60);
  elPolicy.textContent = `Cancelamento at√© ${cancelH}h antes ‚Ä¢ Anteced√™ncia m√≠nima: ${advH}h.`;
}

function fillSelects(){
  elSvc.innerHTML = "";
  for(const s of SERVICES){
    const opt = document.createElement("option");
    opt.value = s.id;
    opt.textContent = `${s.name} ‚Ä¢ ${s.duration_min}min${(s.price!=null) ? " ‚Ä¢ "+money(s.price) : ""}`;
    elSvc.appendChild(opt);
  }

  elBarber.innerHTML = "";
  for(const b of BARBERS){
    const opt = document.createElement("option");
    opt.value = b.id;
    opt.textContent = b.name;
    elBarber.appendChild(opt);
  }

  elDate.innerHTML = "";
  const max = CFG?.max_days_ahead ?? 14;
  const start = LV.todayISO();

  for(let i=0;i<=max;i++){
    const d = LV.addDaysISO(start, i);
    const wd = LV.weekdayIndex(d);
    const h = getHourForISO(d);
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = `${weekdayName(wd)} ‚Ä¢ ${LV.formatBR(d)}${h.open ? "" : " (fechado)"}`;
    if(!h.open) opt.disabled = true;
    elDate.appendChild(opt);
  }
}

async function refreshBookingCache(){
  const dateISO = elDate.value;
  const barberId = elBarber.value;
  if(!dateISO || !barberId) return;

  const key = `${dateISO}__${barberId}`;
  if(key === bookingCacheKey) return;

  bookingCacheKey = key;
  try{
    bookingCache = await DB.listBookingsForSlotCalc({ dateISO, barberId });
  }catch(e){
    bookingCache = [];
    console.error(e);
  }
}

function computeSlotsLocal({ dateISO, barberId, serviceId }){
  const service = SERVICES.find(s => s.id === serviceId);
  if(!service) return { slots:[], reason:"Servi√ßo inv√°lido." };

  const h = getHourForISO(dateISO);
  if(!h.open) return { slots:[], reason:"Fechado neste dia." };

  const startMin = LV.toMin(h.start_time);
  const endMin = LV.toMin(h.end_time);
  const duration = Number(service.duration_min || 30);
  const step = Math.max(5, Number(CFG?.slot_interval_min ?? 10));

  const relevant = bookingCache;

  const isOverlapping = (tStartMin, tEndMin) => {
    for(const b of relevant){
      const bs = LV.toMin(b.time_hhmm);
      const be = bs + Number(b.duration_min||0);
      if(Math.max(tStartMin, bs) < Math.min(tEndMin, be)) return true;
    }
    return false;
  };

  const { iso: nowISO, hhmm: nowHHMM } = LV.nowISOTime();
  const minAdvance = Number(CFG?.min_advance_min ?? 60);

  const slots = [];
  for(let t = startMin; t + duration <= endMin; t += step){
    const time = LV.toHHMM(t);

    let okAdvance = true;
    if(dateISO === nowISO){
      const minTs = LV.ts(nowISO, nowHHMM) + minAdvance*60*1000;
      okAdvance = LV.ts(dateISO, time) >= minTs;
    }

    const available = okAdvance && !isOverlapping(t, t+duration);
    slots.push({ timeHHMM: time, available });
  }
  return { slots, reason: slots.some(s=>s.available) ? "" : "Sem hor√°rios dispon√≠veis." };
}

async function renderSlots(){
  selectedTime = null;
  elSlots.innerHTML = "";
  elSlotsHint.textContent = "";

  const dateISO = elDate.value;
  const barberId = elBarber.value;
  const serviceId = elSvc.value;
  if(!dateISO || !barberId || !serviceId) return;

  await refreshBookingCache();
  const { slots, reason } = computeSlotsLocal({ dateISO, barberId, serviceId });
  if(reason) elSlotsHint.textContent = reason;

  for(const s of slots){
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "slot";
    btn.textContent = s.timeHHMM;
    btn.setAttribute("aria-disabled", String(!s.available));
    btn.setAttribute("aria-selected", "false");
    if(!s.available) btn.disabled = true;

    btn.addEventListener("click", () => {
      selectedTime = s.timeHHMM;
      [...elSlots.querySelectorAll(".slot")].forEach(x=>x.setAttribute("aria-selected","false"));
      btn.setAttribute("aria-selected","true");
    });

    elSlots.appendChild(btn);
  }
}

function showReceipt(b){
  receipt.style.display = "block";
  receiptCode.textContent = `C√≥digo: ${b.id}`;
  receiptMeta.textContent = `${b.customer_name} ‚Ä¢ ${LV.formatBR(b.date_iso)} √†s ${b.time_hhmm}`;

  receiptPills.innerHTML = "";
  const p1 = document.createElement("span"); p1.className="pill brand"; p1.textContent = b.service_name;
  const p2 = document.createElement("span"); p2.className="pill info";  p2.textContent = `Com ${b.barber_name}`;
  const p3 = document.createElement("span"); p3.className="pill";       p3.textContent = `${b.duration_min}min`;
  const p4 = document.createElement("span"); p4.className="pill";       p4.textContent = b.price!=null ? ("Valor: "+money(b.price)) : "Valor: ‚Äî";
  receiptPills.append(p1,p2,p3,p4);
}

function downloadICS(b){
  const start = new Date(`${b.date_iso}T${b.time_hhmm}:00`);
  const end = new Date(start.getTime() + (Number(b.duration_min||30))*60000);
  const pad = (n)=>String(n).padStart(2,"0");
  const toICS = (d)=>(
    d.getUTCFullYear()+
    pad(d.getUTCMonth()+1)+
    pad(d.getUTCDate())+"T"+
    pad(d.getUTCHours())+
    pad(d.getUTCMinutes())+
    pad(d.getUTCSeconds())+"Z"
  );

  const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Las Vegas Barbearia//Agendamento//PT-BR
BEGIN:VEVENT
UID:${b.id}
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(start)}
DTEND:${toICS(end)}
SUMMARY:${(CFG?.brand_name||"Barbearia")} - ${b.service_name}
DESCRIPTION:Barbeiro: ${b.barber_name}\\nC√≥digo: ${b.id}
END:VEVENT
END:VCALENDAR`;

  const blob = new Blob([ics], {type:"text/calendar;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `${b.id}.ics`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

function canCancel(b){
  const limitMin = Number(CFG?.cancel_limit_min ?? 180);
  const t = new Date(`${b.date_iso}T${b.time_hhmm}:00`).getTime();
  return Date.now() <= (t - limitMin*60000);
}

async function createBooking(){
  const service = SERVICES.find(s=>s.id===elSvc.value);
  const barber = BARBERS.find(b=>b.id===elBarber.value);

  if(!service || !barber) return LV.toast("Selecione servi√ßo e barbeiro.");
  if(!elDate.value) return LV.toast("Selecione uma data.");
  if(!selectedTime) return LV.toast("Selecione um hor√°rio.");

  const name = (elName.value||"").trim();
  const phoneRaw = (elPhone.value||"").trim();
  const phone = normPhone(phoneRaw);

  if(name.length < 2) return LV.toast("Digite seu nome.");
  if(phone.length < 10) return LV.toast("Digite um telefone v√°lido.");

  bookingCacheKey = "";
  await refreshBookingCache();
  const { slots } = computeSlotsLocal({ dateISO: elDate.value, barberId: barber.id, serviceId: service.id });
  const found = slots.find(x=>x.timeHHMM===selectedTime);
  if(!found || !found.available) return LV.toast("Esse hor√°rio n√£o est√° mais dispon√≠vel. Escolha outro.");

  const code = LV.uid("LV-");
  const booking = {
    id: code,
    created_at: new Date().toISOString(),
    customer_name: name,
    customer_phone: phone,
    notes: (elNotes.value||"").trim(),
    date_iso: elDate.value,
    time_hhmm: selectedTime,
    service_id: service.id,
    service_name: service.name,
    duration_min: Number(service.duration_min||30),
    price: service.price,
    barber_id: barber.id,
    barber_name: barber.name,
    status: "confirmado",
    updated_at: new Date().toISOString()
  };

  try{
    await DB.createBooking(booking);
    lastCreated = booking;
    showReceipt(booking);
    LV.toast("Agendamento confirmado!");
    bookingCacheKey = "";
    await renderSlots();
    await renderMyBookings();
  }catch(e){
    const msg = String(e?.message || e);
    if(msg.toLowerCase().includes("duplicate") || msg.toLowerCase().includes("unique")){
      LV.toast("Esse hor√°rio acabou de ser ocupado. Escolha outro.");
      bookingCacheKey = "";
      await renderSlots();
      return;
    }
    console.error(e);
    LV.toast("Erro ao salvar agendamento.");
  }
}

async function renderMyBookings(){
  const p = normPhone(lookupPhone.value);
  myList.innerHTML = "";

  if(p.length < 10){
    myList.innerHTML = `<div class="muted small">Digite seu telefone para listar seus agendamentos.</div>`;
    return;
  }

  let all = [];
  try{
    all = await DB.listMyBookingsByPhone(p);
  }catch(e){
    console.error(e);
    myList.innerHTML = `<div class="muted small">Erro ao carregar agendamentos.</div>`;
    return;
  }

  if(all.length === 0){
    myList.innerHTML = `<div class="muted small">Nenhum agendamento encontrado para esse telefone.</div>`;
    return;
  }

  const statusPill = (st) => {
    const map = {
      confirmado: ["ok","Confirmado"],
      concluido: ["ok","Conclu√≠do"],
      pendente: ["info","Pendente"],
      cancelado: ["bad","Cancelado"],
      nao_compareceu: ["bad","N√£o compareceu"],
    };
    const [cls, txt] = map[st] || ["","Status"];
    return `<span class="pill ${cls}">${txt}</span>`;
  };

  for(const b of all){
    const div = document.createElement("div");
    div.className = "item";

    const cancelDisabled = !canCancel(b) || ["cancelado","concluido","nao_compareceu"].includes(b.status);

    div.innerHTML = `
      <div class="top">
        <div>
          <div class="title">${b.service_name} ‚Ä¢ ${LV.formatBR(b.date_iso)} √†s ${b.time_hhmm}</div>
          <div class="meta">Com ${b.barber_name} ‚Ä¢ C√≥digo ${b.id}</div>
          <div class="pills">
            ${statusPill(b.status)}
            <span class="pill">${b.duration_min}min</span>
          </div>
        </div>
        <div class="row">
          <button class="btn secondary" data-act="ics">Calend√°rio</button>
          <button class="btn" data-act="cancel" ${cancelDisabled ? "disabled":""} style="border-color: rgba(251,113,133,.26); background: rgba(251,113,133,.10);">
            Cancelar
          </button>
        </div>
      </div>
    `;

    div.querySelector('[data-act="ics"]').addEventListener("click", ()=>downloadICS(b));
    div.querySelector('[data-act="cancel"]').addEventListener("click", async ()=>{
      if(!canCancel(b)) return LV.toast("Fora do prazo para cancelamento.");
      try{
        await DB.cancelBooking({ id: b.id, phone: p });
        LV.toast("Agendamento cancelado.");
        bookingCacheKey = "";
        await renderMyBookings();
        await renderSlots();
      }catch(e){
        console.error(e);
        LV.toast("Erro ao cancelar.");
      }
    });

    myList.appendChild(div);
  }
}

/** Boot */
async function boot(){
  try{
    CFG = await DB.getConfig();
    if(!CFG){
      LV.toast("Config n√£o encontrada. Abra o Admin e salve a config.");
      CFG = { brand_name:"Barbearia Las Vegas", slot_interval_min:10, min_advance_min:60, cancel_limit_min:180, max_days_ahead:14 };
    }

    const [services, barbers, hours] = await Promise.all([
      DB.listServices(),
      DB.listBarbers(),
      DB.listHours()
    ]);

    SERVICES = services;
    BARBERS = barbers;
    HOURS = new Map();
    for(const h of hours){
      HOURS.set(Number(h.weekday), h);
    }

    refreshTop();
    fillSelects();
    await renderSlots();
    await renderMyBookings();
  }catch(e){
    console.error(e);
    LV.toast("Erro ao conectar no Supabase. Veja console.");
  }
}

/** Events */
elSvc.addEventListener("change", async ()=>{ bookingCacheKey=""; await renderSlots(); });
elBarber.addEventListener("change", async ()=>{ bookingCacheKey=""; await renderSlots(); });
elDate.addEventListener("change", async ()=>{ bookingCacheKey=""; await renderSlots(); });

elConfirm.addEventListener("click", createBooking);

lookupBtn.addEventListener("click", renderMyBookings);
lookupPhone.addEventListener("keyup", (e)=>{ if(e.key==="Enter") renderMyBookings(); });

icsBtn.addEventListener("click", ()=>{ if(lastCreated) downloadICS(lastCreated); });

boot();
  </script>
</body>
</html>
